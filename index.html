<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Login e Cadastro com Monkey Sheet e Uploadcare</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

<style>
  * { box-sizing: border-box; }
  body {
    background-color: #f4f7fc;
    font-family: 'Roboto', sans-serif;
    margin: 0;
    padding: 0;
  }
  .tabs {
    display: flex;
    justify-content: center;
    background: #2c3e50;
    color: white;
    padding: 20px 0;
  }
  .tab {
    margin: 0 30px;
    cursor: pointer;
    font-weight: 500;
    font-size: 18px;
  }
  .tab:hover {
    color: #1abc9c;
  }
  .active {
    border-bottom: 3px solid #1abc9c;
    padding-bottom: 10px;
  }
  .form-container, .login-container {
    background: white;
    margin: 40px auto;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    width: 90%;
    max-width: 700px;
  }
  h2 {
    text-align: center;
    color: #2c3e50;
    margin-bottom: 20px;
  }
  input[type="text"], input[type="password"], input[type="date"], input[type="email"], input[type="tel"] {
    width: 100%;
    margin: 12px 0;
    padding: 14px;
    border-radius: 8px;
    border: 1px solid #ddd;
    font-size: 16px;
  }
  input:focus {
    border-color: #1abc9c;
    outline: none;
  }
  button {
    background-color: #1abc9c;
    color: white;
    padding: 15px;
    border: none;
    width: 100%;
    border-radius: 8px;
    font-size: 18px;
    cursor: pointer;
  }
  button:hover {
    background-color: #16a085;
  }
  .blue-button {
    background-color: #3498db;
    margin-top: 15px;
  }
  .blue-button:hover {
    background-color: #2980b9;
  }
  .lgpd-box {
    display: flex;
    align-items: center;
    margin: 10px 0;
  }
  .lgpd-box input[type="checkbox"] {
    margin-right: 10px;
  }
  label.date-label {
    display: block;
    margin-top: 15px;
    font-weight: 500;
    font-size: 16px;
  }

  /* Modal base */
  .modal, .alterar-modal {
    display: none;
    position: fixed;
    z-index: 10000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(2px);
    background-color: rgba(0,0,0,0.4);
    justify-content: center;
    align-items: center;
  }
  .modal-content, .alterar-content {
  background: #d4edda; /* verde claro */
  padding: 30px;
  border-radius: 20px;
  width: 90%;
  max-width: 400px;
  box-shadow: 0 0 20px rgba(0,0,0,0.2);
  text-align: center;
  border: 2px solid #1abc9c;
}

  }
  .modal-content h2 {
    color: #00c853;
    margin-bottom: 20px;
  }
  .alterar-content h2 {
    color: #2c3e50;
    margin-bottom: 15px;
  }
  .options-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin: 15px 0;
  }
  .option-btn {
    background-color: #1abc9c;
    border: none;
    padding: 12px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
  }
  
  .option-btn.clicked {
    background-color: blue;
    color: white; /* para texto ficar visível */
}

  .option-btn:hover {
    background-color: #d0d7db;
  }
  .hidden {
    display: none;
  }
</style>

<!-- Uploadcare widget -->
<script src="https://ucarecdn.com/libs/widget/3.x/uploadcare.full.min.js" charset="utf-8"></script>

</head>

<body>

<div class="tabs">
  <div class="tab active">M&G</div>
</div>

<!-- TELA DE LOGIN INICIAL -->
<div class="login-container" id="loginScreen">
  <h2>Login</h2>
  <input type="text" id="loginInput" placeholder="Login" autocomplete="username" required />
  <input type="password" id="senhaInput" placeholder="Senha" autocomplete="current-password" required />
  <button id="btnConfirmar">Confirmar</button>
  <button type="button" class="blue-button" id="btnJaCadastrado">Já sou cadastrado</button>
</div>

<!-- FORMULÁRIO DE CADASTRO -->
<form id="formulario" class="hidden">
  <div class="form-container">
    <h2>Cadastro</h2>
    <input type="text" name="Nome" placeholder="Nome" required />
    <input type="text" name="RG" placeholder="RG" required />
    <input type="text" name="CPF" placeholder="CPF" required />

    <div class="lgpd-box">
      <input type="checkbox" id="lgpd" name="Consentimento LGPD" value="Aceito" required />
      <label for="lgpd">Consentimento de Acordo com a LGPD</label>
    </div>

    <input type="text" name="CRM" placeholder="CRM" required />
    <input type="text" name="Endereço" placeholder="Endereço" />
    <input type="text" name="CEP" placeholder="CEP" />
    <input type="text" name="Código do Banco" placeholder="Código do Banco" />
    <input type="text" name="Agência" placeholder="Agência" />
    <input type="text" name="Banco" placeholder="Nome do Banco" />
    <input type="text" name="Pix" placeholder="Pix" />

    <label class="date-label">Data de Nascimento</label>
    <input type="date" name="Data de Nascimento" required />

    <label class="date-label">Data de Expedição do RG</label>
    <input type="date" name="Data de Expedição RG" required />

    <input type="email" name="Email" placeholder="E-mail" required />
    <input type="tel" name="WhatsApp" placeholder="WhatsApp" required />

    <!-- Uploadcare widget -->
    <label for="uploadcare">Envie seu arquivo:</label>
    <input
      type="hidden"
      role="uploadcare-uploader"
      name="uploadcare"
      data-clearable="true"
      data-images-only="true"
      data-multiple="false"
      data-public-key="5e1d448219881e1f1ea3"
      required
    />

    <button type="submit">Cadastrar</button>
  </div>
</form>

<!-- Modal de Sucesso -->
<div class="modal" id="successModal">
  <div class="modal-content">
    <h2>✅ Cadastro realizado com sucesso!</h2>
    <button onclick="fecharModal()">Confirmar</button>
  </div>
</div>

<!-- Modal Login para "Já sou cadastrado" -->
<div class="modal" id="modalLoginExistente">
  <div class="modal-content">
    <h2>Login</h2>
    <input type="text" id="loginExistente" placeholder="Login" autocomplete="username" required />
    <input type="password" id="senhaExistente" placeholder="Senha" autocomplete="current-password" required />
    <button id="btnConfirmarExistente">Confirmar</button>
    <button onclick="fecharModalLoginExistente()" style="margin-top:10px; background:#e74c3c;">Cancelar</button>
  </div>
</div>

<!-- Modal de Alteração -->
<div class="alterar-modal" id="alterarModal">
  <div class="alterar-content">
    <h2>Alterar Dados do Cadastro</h2>
    <input type="text" id="nomeAlterar" placeholder="Nome" />
    <input type="text" id="crmAlterar" placeholder="CRM" />

    <div class="options-container">
      <button class="option-btn" onclick="selecionarCampo('CRM')">CRM</button>
      <button class="option-btn" onclick="selecionarCampo('Estado Civil')">Estado Civil</button>
      <button class="option-btn" onclick="selecionarCampo('CEP')">CEP</button>
      <button class="option-btn" onclick="selecionarCampo('Endereço')">Endereço</button>
      <button class="option-btn" onclick="selecionarCampo('Banco')">Banco</button>
      <button class="option-btn" onclick="selecionarCampo('Agência')">Agência</button>
      <button class="option-btn" onclick="selecionarCampo('Pix')">Pix</button>
    </div>

    <input type="text" id="novoValor" class="hidden" placeholder="Digite o novo valor" />

    <button type="button" onclick="realizarAlteracao()">Cadastrar</button>
  </div>
</div>

<script>
  const btn = document.querySelector('.option-btn');

  btn.addEventListener('click', () => {
    btn.classList.toggle('clicked');
  });
</script>


<!-- Modal de Confirmação de Alteração -->
<div class="modal" id="alteracaoFeitaModal">
  <div class="modal-content">
    <h2>✅ Alteração no cadastro realizada!</h2>
    <button onclick="fecharModal()">Confirmar</button>
  </div>
</div>

<script>
  // URL do Google Apps Script Monkey Sheet
  const MONKEY_SHEET_URL = 'https://api.sheetmonkey.io/form/vbZYP354FHVGkFzhRNhtpd';

  // Variáveis DOM
  const loginScreen = document.getElementById('loginScreen');
  const formulario = document.getElementById('formulario');
  const btnConfirmar = document.getElementById('btnConfirmar');
  const btnJaCadastrado = document.getElementById('btnJaCadastrado');

  const modalLoginExistente = document.getElementById('modalLoginExistente');
  const btnConfirmarExistente = document.getElementById('btnConfirmarExistente');

  // Login e senha válidos (exemplo simples)
  const LOGIN_VALIDO = 'usuario';
  const SENHA_VALIDA = 'senha123';

  // Evento botão Confirmar (login inicial)
  btnConfirmar.addEventListener('click', () => {
    const login = document.getElementById('loginInput').value.trim();
    const senha = document.getElementById('senhaInput').value.trim();

    if(login === LOGIN_VALIDO && senha === SENHA_VALIDA) {
      loginScreen.style.display = 'none';
      formulario.classList.remove('hidden');
    } else {
      alert('Login ou senha inválidos.');
    }
  });

  // Evento botão "Já sou cadastrado" - abrir modal login secundário
  btnJaCadastrado.addEventListener('click', () => {
    abrirModalLoginExistente();
  });

  function abrirModalLoginExistente() {
    modalLoginExistente.style.display = 'flex';
    document.getElementById('loginExistente').value = '';
    document.getElementById('senhaExistente').value = '';
    document.getElementById('loginExistente').focus();
  }

  function fecharModalLoginExistente() {
    modalLoginExistente.style.display = 'none';
  }

  // Confirmar login dentro do modal de login existente
  btnConfirmarExistente.addEventListener('click', () => {
    const login = document.getElementById('loginExistente').value.trim();
    const senha = document.getElementById('senhaExistente').value.trim();

    if(login === LOGIN_VALIDO && senha === SENHA_VALIDA) {
      fecharModalLoginExistente();
      abrirAlterar();
    } else {
      alert('Login ou senha inválidos.');
    }
  });

  // Abrir modal alteração cadastro
  const alterarModal = document.getElementById('alterarModal');
  const novoValorInput = document.getElementById('novoValor');
  let campoSelecionado = '';

  function abrirAlterar() {
    alterarModal.style.display = 'flex';
    // Opcional: Limpar campos
    document.getElementById('nomeAlterar').value = '';
    document.getElementById('crmAlterar').value = '';
    novoValorInput.value = '';
    novoValorInput.classList.add('hidden');
    campoSelecionado = '';
  }

  function fecharModal() {
    document.getElementById('successModal').style.display = 'none';
    document.getElementById('alteracaoFeitaModal').style.display = 'none';
  }

  // Selecionar campo a alterar
  function selecionarCampo(campo) {
    campoSelecionado = campo;
    novoValorInput.placeholder = `Digite o novo valor para ${campoSelecionado}`;
    novoValorInput.classList.remove('hidden');
    novoValorInput.focus();
  }

  // Função para realizar a alteração (exemplo simples)
  function realizarAlteracao() {
    const nome = document.getElementById('nomeAlterar').value.trim();
    const crm = document.getElementById('crmAlterar').value.trim();
    const novoValor = novoValorInput.value.trim();

    if(!nome || !crm || !campoSelecionado || !novoValor) {
      alert('Preencha todos os campos e selecione o campo a alterar.');
      return;
    }

    // Aqui você pode implementar a lógica para enviar essa alteração para o Monkey Sheet
    // Por exemplo, via fetch POST enviando dados no formato esperado.

    // Exemplo simples de sucesso:
    alterarModal.style.display = 'none';
    document.getElementById('alteracaoFeitaModal').style.display = 'flex';
  }

  // Fecha modais ao clicar fora do conteúdo
  window.addEventListener('click', (event) => {
    if(event.target === modalLoginExistente) {
      fecharModalLoginExistente();
    }
    if(event.target === alterarModal) {
      alterarModal.style.display = 'none';
    }
    if(event.target === document.getElementById('successModal')) {
      fecharModal();
    }
    if(event.target === document.getElementById('alteracaoFeitaModal')) {
      fecharModal();
    }
  });

  // Envio do formulário de cadastro via Monkey Sheet
  formulario.addEventListener('submit', (e) => {
    e.preventDefault();

    // Coleta dados do formulário
    const formData = new FormData(formulario);

    // Envio para o Monkey Sheet
    fetch(MONKEY_SHEET_URL, {
      method: 'POST',
      body: formData,
    })
    .then(response => response.json())
    .then(data => {
      if(data.result === 'success') {
        formulario.reset();
        document.getElementById('successModal').style.display = 'flex';
      } else {
        alert('Erro ao enviar dados. Tente novamente.');
      }
    })
    .catch(() => {
      alert('Erro na conexão. Tente novamente.');
    });
  });
</script>

</body>
</html>
